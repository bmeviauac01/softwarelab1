
<!DOCTYPE html>

<html class="no-js" lang="hu">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Albert István, Tóth Tibor" name="author"/>
<link href="https://bmeviauac01.github.io/softwarelab1/hu/Lab-MongoDB/" rel="canonical"/>
<link href="../Lab-MSSQL/" rel="prev"/>
<link href="../Lab-EFREST/" rel="next"/>
<link href="../img/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.4.2, mkdocs-material-9.1.0" name="generator"/>
<title>MongoDB - BMEVIAUAC09 Szoftverfejlesztés laboratórium 1</title>
<link href="../assets/stylesheets/main.402914a4.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.a0c5b2b5.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../css/timeago.css" rel="stylesheet"/>
<link href="../extra-material-theme.css" rel="stylesheet"/>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="red" data-md-color-primary="aut" data-md-color-scheme="aut" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#mongodb">
          Kihagyás
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Élőfej" class="md-header__inner md-grid">
<a aria-label="BMEVIAUAC09 Szoftverfejlesztés laboratórium 1" class="md-header__button md-logo" data-md-component="logo" href=".." title="BMEVIAUAC09 Szoftverfejlesztés laboratórium 1">
<img alt="logo" src="../img/logo-bme-aut.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            BMEVIAUAC09 Szoftverfejlesztés laboratórium 1
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              MongoDB
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to Dark Mode" class="md-option" data-md-color-accent="red" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="aut" data-md-color-scheme="aut" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to Dark Mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"></path></svg>
</label>
<input aria-label="Switch to Light Mode" class="md-option" data-md-color-accent="" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="red" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to Light Mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"></path></svg>
</label>
</form>
<div class="md-header__option">
<div class="md-select">
<button aria-label="Nyelvváltás" class="md-header__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"></path></svg>
</button>
<div class="md-select__inner">
<ul class="md-select__list">
<li class="md-select__item">
<a class="md-select__link" href="https://bmeviauac01.github.io/softwarelab1/en/" hreflang="en">
                    English
                  </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="https://bmeviauac01.github.io/softwarelab1/hu/" hreflang="hu">
                    Magyar
                  </a>
</li>
</ul>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Keresés" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Keresés" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Keresés" class="md-search__options">
<button aria-label="Törlés" class="md-search__icon md-icon" tabindex="-1" title="Törlés" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Keresés inicializálása
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/bmeviauac01/softwarelab1" title="Főoldalra ugrás">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    bmeviauac01/softwarelab1
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Lapok" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="..">
        Szoftverfejlesztés laboratórium 1
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../Lab-PowerBI/">
        Laborok
      </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigáció" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="BMEVIAUAC09 Szoftverfejlesztés laboratórium 1" class="md-nav__button md-logo" data-md-component="logo" href=".." title="BMEVIAUAC09 Szoftverfejlesztés laboratórium 1">
<img alt="logo" src="../img/logo-bme-aut.png"/>
</a>
    BMEVIAUAC09 Szoftverfejlesztés laboratórium 1
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/bmeviauac01/softwarelab1" title="Főoldalra ugrás">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    bmeviauac01/softwarelab1
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          Szoftverfejlesztés laboratórium 1
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
          Szoftverfejlesztés laboratórium 1
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
        Tárgy ismertető
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../GitHub/">
        Feladatok beadása (GitHub)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../GitHub-Actions/">
        GitHub Actions ismertető
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../VisualStudio/">
        Visual Studio &amp; .NET Core SDK telepítése
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../GitHub-credentials/">
        Egyetemi laborokban: GitHub belépés
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Laborok
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Laborok
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Lab-PowerBI/">
        Reporting
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Lab-QueryOptimization/">
        Lekérdezés optimalizálás
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Lab-MSSQL/">
        MSSQL
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          MongoDB
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        MongoDB
      </a>
<nav aria-label="Tartalomjegyzék" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#elofeltetelek-felkeszules">
    Előfeltételek, felkészülés
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#elokeszulet">
    Előkészület
  </a>
<nav aria-label="Előkészület" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#git-repository-letrehozasa-es-letoltese">
    Git repository létrehozása és letöltése
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#adatbazis-letrehozasa">
    Adatbázis létrehozása
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#1-feladat-termekek-lekerdezese-es-modositasa-7-pont">
    1. Feladat: Termékek lekérdezése és módosítása (7 pont)
  </a>
<nav aria-label="1. Feladat: Termékek lekérdezése és módosítása (7 pont)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#visual-studio-solution-megnyitasa">
    Visual Studio solution megnyitása
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#webalkalmazas-elinditasa">
    Webalkalmazás elindítása
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#neptun-kod-megjelenitese-a-weboldalon">
    Neptun kód megjelenítése a weboldalon
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#listazasolvasas">
    Listázás/olvasás
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#letrehozas">
    Létrehozás
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#torles">
    Törlés
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#modositas">
    Módosítás
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-feladat-kategoriak-listazasa-4-pont">
    2. Feladat: Kategóriák listázása (4 pont)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-feladat-megrendelesek-lekerdezese-es-modositasa-5-pont">
    3. Feladat: Megrendelések lekérdezése és módosítása (5 pont)
  </a>
<nav aria-label="3. Feladat: Megrendelések lekérdezése és módosítása (5 pont)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#listazasolvasas_1">
    Listázás/olvasás
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#letrehozas_1">
    Létrehozás
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#torles_1">
    Törlés
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#modositas_1">
    Módosítás
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kiprobalas">
    Kipróbálás
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-feladat-vevok-listazasa-4-pont">
    4. Feladat: Vevők listázása (4 pont)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-feladat-opcionalis-imsc-feladat-3-imsc-pont">
    5. Feladat: Opcionális (iMSc) feladat (3 iMsc pont)
  </a>
<nav aria-label="5. Feladat: Opcionális (iMSc) feladat (3 iMsc pont)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#kovetelmenyek">
    Követelmények
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#megoldas-vazlata">
    Megoldás vázlata
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Lab-EFREST/">
        Entity Framework &amp; REST
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Tartalomjegyzék" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#elofeltetelek-felkeszules">
    Előfeltételek, felkészülés
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#elokeszulet">
    Előkészület
  </a>
<nav aria-label="Előkészület" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#git-repository-letrehozasa-es-letoltese">
    Git repository létrehozása és letöltése
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#adatbazis-letrehozasa">
    Adatbázis létrehozása
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#1-feladat-termekek-lekerdezese-es-modositasa-7-pont">
    1. Feladat: Termékek lekérdezése és módosítása (7 pont)
  </a>
<nav aria-label="1. Feladat: Termékek lekérdezése és módosítása (7 pont)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#visual-studio-solution-megnyitasa">
    Visual Studio solution megnyitása
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#webalkalmazas-elinditasa">
    Webalkalmazás elindítása
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#neptun-kod-megjelenitese-a-weboldalon">
    Neptun kód megjelenítése a weboldalon
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#listazasolvasas">
    Listázás/olvasás
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#letrehozas">
    Létrehozás
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#torles">
    Törlés
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#modositas">
    Módosítás
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-feladat-kategoriak-listazasa-4-pont">
    2. Feladat: Kategóriák listázása (4 pont)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-feladat-megrendelesek-lekerdezese-es-modositasa-5-pont">
    3. Feladat: Megrendelések lekérdezése és módosítása (5 pont)
  </a>
<nav aria-label="3. Feladat: Megrendelések lekérdezése és módosítása (5 pont)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#listazasolvasas_1">
    Listázás/olvasás
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#letrehozas_1">
    Létrehozás
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#torles_1">
    Törlés
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#modositas_1">
    Módosítás
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#kiprobalas">
    Kipróbálás
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-feladat-vevok-listazasa-4-pont">
    4. Feladat: Vevők listázása (4 pont)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-feladat-opcionalis-imsc-feladat-3-imsc-pont">
    5. Feladat: Opcionális (iMSc) feladat (3 iMsc pont)
  </a>
<nav aria-label="5. Feladat: Opcionális (iMSc) feladat (3 iMsc pont)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#kovetelmenyek">
    Követelmények
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#megoldas-vazlata">
    Megoldás vázlata
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/bmeviauac01/softwarelab1/blob/master/docs/hu/Lab-MongoDB/index.md" title="Oldal szerkesztése">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"></path></svg>
</a>
<h1 id="mongodb">MongoDB<a class="headerlink" href="#mongodb" title="Permanent link">¶</a></h1>
<p>A labor során a MongoDB NoSQL adatbáziskezelő rendszer és a Mongo C# driver használatát gyakoroljuk komplexebb feladatokon keresztül.</p>
<h2 id="elofeltetelek-felkeszules">Előfeltételek, felkészülés<a class="headerlink" href="#elofeltetelek-felkeszules" title="Permanent link">¶</a></h2>
<p>A labor elvégzéséhez szükséges eszközök:</p>
<ul>
<li>Windows, Linux, vagy MacOS: Minden szükséges program platform független, vagy van platformfüggetlen alternatívája.</li>
<li>
<p>MongoDB Community Server (<a href="https://www.mongodb.com/download-center/community">letöltés</a>)</p>
<ul>
<li>
<p>Telepítés nélkül Docker segítségével az alábbi paranccsal futtathatod a szervert</p>
<div class="highlight"><pre><span></span><code>docker run --name swlab1-mongo -p 27017:27017 -d mongo
</code></pre></div>
</li>
</ul>
</li>
<li>
<p>Studio 3T Free (<a href="https://studio3t.com/download-studio3t-free">letöltés</a>)</p>
</li>
<li>Minta adatbázis kódja (<a href="../db/mongo.js">mongo.js</a>)</li>
<li>GitHub account és egy git kliens</li>
<li>Microsoft Visual Studio 2022 <a href="../VisualStudio/">az itt található beállításokkal</a><ul>
<li>Linux és MacOS esetén Visual Studio Code és a .NET SDK-val települő <a href="https://docs.microsoft.com/en-us/dotnet/core/tools/">dotnet CLI</a> használható.</li>
</ul>
</li>
<li>
<p><a href="https://dotnet.microsoft.com/en-us/download/dotnet/6.0">.NET <strong>6.0</strong> SDK</a></p>
<div class="admonition warning">
<p class="admonition-title">.NET Core 6.0</p>
<p>A feladat megoldásához <strong>6.0</strong>-es .NET Core SDK telepítése szükséges.</p>
<p>Windows-on Visual Studio verzió függvényében lehet, hogy telepítve van (lásd <a href="../VisualStudio/#net-core-sdk-ellenorzese-es-telepitese">itt</a> az ellenőrzés módját); ha nem, akkor a fenti linkről kell telepíteni (az SDK-t és <em>nem</em> a runtime-ot.) Linux és MacOS esetén telepíteni szükséges.</p>
</div>
</li>
</ul>
<p>A labor elvégzéséhez használható segédanyagok és felkészülési anyagok:</p>
<ul>
<li>MongoDB adatbáziskezelő rendszer és a C# driver használata<ul>
<li>Lásd az Adatvezérelt rendszerek c. tárgy jegyzetei és <a href="https://bmeviauac01.github.io/datadriven/hu/">gyakorlati anyagai</a> között</li>
</ul>
</li>
<li>Hivatalos Microsoft tutorial <a href="https://learn.microsoft.com/en-us/aspnet/core/tutorials/first-mongo-app?view=aspnetcore-6.0&amp;tabs=visual-studio">Mongo-t használó Web API készítéséhez</a><ul>
<li>A labor során nem WebAPI-t készítünk, de a Mongo használat azonos formában történik.</li>
</ul>
</li>
</ul>
<h2 id="elokeszulet">Előkészület<a class="headerlink" href="#elokeszulet" title="Permanent link">¶</a></h2>
<p>A feladatok megoldása során ne felejtsd el követni a <a href="../GitHub/">feladat beadás folyamatát</a>.</p>
<h3 id="git-repository-letrehozasa-es-letoltese">Git repository létrehozása és letöltése<a class="headerlink" href="#git-repository-letrehozasa-es-letoltese" title="Permanent link">¶</a></h3>
<ol>
<li>
<p>Moodle-ben keresd meg a laborhoz tartozó meghívó URL-jét és annak segítségével hozd létre a saját repository-dat.</p>
</li>
<li>
<p>Várd meg, míg elkészül a repository, majd checkout-old ki.</p>
<div class="admonition warning">
<p class="admonition-title">Jelszó a laborokban</p>
<p>Egyetemi laborokban, ha a checkout során nem kér a rendszer felhasználónevet és jelszót, és nem sikerül a checkout, akkor valószínűleg a gépen korábban megjegyzett felhasználónévvel próbálkozott a rendszer. Először töröld ki a mentett belépési adatokat (lásd <a href="../GitHub-credentials/">itt</a>), és próbáld újra.</p>
</div>
</li>
<li>
<p>Hozz létre egy új ágat <code>megoldas</code> néven, és ezen az ágon dolgozz.</p>
</li>
<li>
<p>A <code>neptun.txt</code> fájlba írd bele a Neptun kódodat. A fájlban semmi más ne szerepeljen, csak egyetlen sorban a Neptun kód 6 karaktere.</p>
</li>
</ol>
<h3 id="adatbazis-letrehozasa">Adatbázis létrehozása<a class="headerlink" href="#adatbazis-letrehozasa" title="Permanent link">¶</a></h3>
<p>Kövesd a <a href="https://bmeviauac01.github.io/datadriven/hu/gyakorlat/mongodb/#feladat-0-adatbazis-letrehozasa-projekt-megnyitasa">gyakorlatanyagban</a> leírt utasításokat az adatbáziskezelő rendszer elindításához és az adatbázis létrehozásához.</p>
<h2 id="1-feladat-termekek-lekerdezese-es-modositasa-7-pont">1. Feladat: Termékek lekérdezése és módosítása (7 pont)<a class="headerlink" href="#1-feladat-termekek-lekerdezese-es-modositasa-7-pont" title="Permanent link">¶</a></h2>
<p>Ebben a feladatban a <code>Product</code> entitáshoz tartozó CRUD (létrehozás, listázás/olvasás, módosítás és törlés) utasításokat fogjuk megvalósítani.</p>
<h3 id="visual-studio-solution-megnyitasa">Visual Studio solution megnyitása<a class="headerlink" href="#visual-studio-solution-megnyitasa" title="Permanent link">¶</a></h3>
<p>Nyisd meg a letöltött repository-ban a Visual Studio solution-t (<code>.sln</code> fájl). Ha a megnyitás során a Visual Studio azt jelezné, hogy a projekt típus nem támogatott, akkor telepítsd a Visual Studio hiányzó komponenseit (lásd <a href="../VisualStudio/">itt</a>).</p>
<div class="admonition warning">
<p class="admonition-title">NE frissíts semmilyen verziót</p>
<p>Ne frissítsd se a projektet, se a .NET verziót, se a NuGet csomagokat! Ha ilyen kérdéssel találkozol a solution megnyitása során, akkor mindig mondj nemet!</p>
</div>
<p>Munkád során a <code>Dal.Repository</code> osztályba dolgozz! Ezen fájl tartalmát tetszőlegesen módosíthatod (feltéve, hogy továbbra is megvalósítja a <code>Dal.IRepository</code> interfészt, továbbra is van egy konstruktora egyetlen <code>IMongoDatabase</code> paraméterrel és természetesen továbbra is fordul a kód).</p>
<p>Az adatbázis elérése a <code>Dal.MongoConnectionConfig</code> osztályban van. Ha szükséges, az adatbázis nevét megváltoztathatod a forrásban jelölt helyen.</p>
<p>A projekt minden egyéb tartalma már elő van készítve a munkához, a fentieken kívül máshol <strong>NE</strong> módosítsd!</p>
<div class="admonition info">
<p class="admonition-title">Razor Pages</p>
<p>A webalkalmazás egy un. <a href="https://docs.microsoft.com/en-us/aspnet/core/razor-pages/"><em>Razor Pages</em></a> típusú ASP.NET Core projekt. Ezt egy szerver oldalon renderelt megjelenítési réteg, ahol tehát a weboldal html kódját C# kód és a Razor template állítja elő. (A megjelenítési réteggel nem lesz feladatod, az már elő van készítve számodra.)</p>
</div>
<h3 id="webalkalmazas-elinditasa">Webalkalmazás elindítása<a class="headerlink" href="#webalkalmazas-elinditasa" title="Permanent link">¶</a></h3>
<p>Próbáld ki, hogy elindul-e a program.</p>
<ol>
<li>
<p>Fordítsd le és indítsd el Visual Studio-ból az alkalmazást.</p>
</li>
<li>
<p>Nyisd meg böngészőben a <a href="http://localhost:5000/">http://localhost:5000/</a> oldalt.</p>
</li>
</ol>
<div class="admonition success">
<p>Ha minden rendben ment, akkor bejött egy oldal, ahol az egyes feladatokat ki fogod tudni próbálni. (Az egyes feladatokra mutató linkek mögötti oldalak még nem működnek. Előbb még meg kell valósítani az adatelérési réteget.)</p>
</div>
<h3 id="neptun-kod-megjelenitese-a-weboldalon">Neptun kód megjelenítése a weboldalon<a class="headerlink" href="#neptun-kod-megjelenitese-a-weboldalon" title="Permanent link">¶</a></h3>
<p>A forráskód melletti képernyőképeken szerepelnie kell a Neptun kódodnak.</p>
<ol>
<li>
<p>Nyisd meg a <code>Pages\Shared\_Layout.cshtml</code> fájlt. A fájl közepe felé keresd meg az alábbi részt, és írd át benne a Neptun kódodat.</p>
<div class="highlight"><pre><span></span><code><span class="o">&lt;</span><span class="n">div</span><span class="w"> </span><span class="n">class</span><span class="o">=</span><span class="s">"container body-content"</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">@RenderBody</span><span class="p">()</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">hr</span><span class="w"> </span><span class="o">/&gt;</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">footer</span><span class="o">&gt;</span>
<span class="hll"><span class="w">        </span><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">@ViewData</span><span class="p">[</span><span class="s">"Title"</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">NEPTUN</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class="w">    </span><span class="o">&lt;/</span><span class="n">footer</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</code></pre></div>
</li>
<li>
<p>Fordítsd le és indítsd el az alkalmazást ismét, nézd meg a kezdőoldalt. Az alján kell lásd a saját Neptun kódod.</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../images/mongo/mongo-neptun-footer.png"><img alt="Neptun kód a láblécben" src="../images/mongo/mongo-neptun-footer.png"/></a></p>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">FONTOS</p>
<p>A Neptun kódnak a fentiek szerint szerepelnie kell minden képernyőképen!</p>
</div>
<h3 id="listazasolvasas">Listázás/olvasás<a class="headerlink" href="#listazasolvasas" title="Permanent link">¶</a></h3>
<ol>
<li>
<p>Első lépésként szükség lesz az adatbázisban található <code>products</code> kollekció elérésére a kódból. Ehhez vegyél fel egy új mezőt a <code>Repository</code> osztályban, és inicializáld ezt a konstruktorban. Az ehhez szükséges <code>IMongoDatabase</code> objektumot <em>Dependency Injection</em> segítségével, konstruktorparaméterként kaphatod meg.</p>
<div class="highlight"><pre><span></span><code><span class="k">private</span><span class="w"> </span><span class="k">readonly</span><span class="w"> </span><span class="n">IMongoCollection</span><span class="o">&lt;</span><span class="n">Entities</span><span class="p">.</span><span class="n">Product</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_productCollection</span><span class="p">;</span>

<span class="k">public</span><span class="w"> </span><span class="nf">Repository</span><span class="p">(</span><span class="n">IMongoDatabase</span><span class="w"> </span><span class="n">database</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="n">_productCollection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">database</span><span class="p">.</span><span class="n">GetCollection</span><span class="o">&lt;</span><span class="n">Entities</span><span class="p">.</span><span class="n">Product</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"products"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
</li>
<li>
<p>A <code>_productCollection</code> segítségével már tudunk lekérdező/listázó utasításokat írni. Valósítsuk meg először a <code>ListProducts</code> függvényt. Ez a függvény két lépésből áll: először lekérdezzük az adatbázisból a termékek listáját, majd pedig átkonvertáljuk az elvárt <code>Models.Product</code> osztály elemekből álló listára.</p>
<p>A lekérdezés a következőképpen néz ki:</p>
<div class="highlight"><pre><span></span><code><span class="kt">var</span><span class="w"> </span><span class="n">dbProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_productCollection</span>
<span class="w">    </span><span class="p">.</span><span class="n">Find</span><span class="p">(</span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">true</span><span class="p">)</span><span class="w"> </span><span class="c1">// minden terméket listázunk — üres filter</span>
<span class="w">    </span><span class="p">.</span><span class="n">ToList</span><span class="p">();</span>
</code></pre></div>
<p>Ezt a listát aztán transzformálva adjuk vissza.</p>
<div class="highlight"><pre><span></span><code><span class="k">return</span><span class="w"> </span><span class="n">dbProducts</span>
<span class="w">    </span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Product</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">Id</span><span class="p">.</span><span class="n">ToString</span><span class="p">(),</span>
<span class="w">        </span><span class="n">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span>
<span class="w">        </span><span class="n">Price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">Price</span><span class="p">,</span>
<span class="w">        </span><span class="n">Stock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">Stock</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="p">.</span><span class="n">ToList</span><span class="p">();</span>
</code></pre></div>
</li>
<li>
<p>A <code>FindProduct(string id)</code> függvény megvalósítása nagyon hasonlít az előzőhöz, csupán annyiban különbözik, hogy itt egyetlen terméket kérdezünk le, <code>id</code> alapján. Ügyeljünk rá, hogy az <code>id</code>-t szövegként kapjuk, így <code>ObjectId</code>-vá kell alakítani.</p>
<p>A modellé konvertáló lépés ugyanúgy megmarad. Ebben az esetben oda kell figyelnünk azonban, hogy ha nem találjuk az adott terméket, akkor adjunk vissza <code>null</code> értéket, ne próbáljunk konvertálni.</p>
<p>A lekérdező lépés a következőre módosul:</p>
<div class="highlight"><pre><span></span><code><span class="kt">var</span><span class="w"> </span><span class="n">dbProduct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_productCollection</span>
<span class="w">    </span><span class="p">.</span><span class="n">Find</span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">Id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ObjectId</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">id</span><span class="p">))</span>
<span class="w">    </span><span class="p">.</span><span class="n">SingleOrDefault</span><span class="p">();</span>
<span class="c1">// ... model konverzio</span>
</code></pre></div>
<p>Figyeljük itt meg, hogy hogyan módosult a filter kifejezés! Fontos továbbá, hogy itt <code>ToList</code> helyett a <code>SingleOrDefault</code> kiértékelő kifejezést használjuk. Ez a megszokott módon vagy egy konkrét terméket ad vissza, vagy <code>null</code> értéket. Így tudunk tehát <code>Id</code> alapján megtalálni egy entitást az adatbázisban. Jegyezzük ezt meg, mert ez még sok következő feladatban hasznos lesz!</p>
<p>A konvertáló kifejezést már megírtuk egyszer az előző kifejezésben, ezt használhatjuk itt is — figyeljünk azonban oda, hogy a <code>dbProduct</code> értéke lehet <code>null</code> is. Ebben az esetben ne konvertáljunk, csupán adjunk vissza <code>null</code> értéket mi is.</p>
</li>
<li>
<p>Próbáld ki a megírt függvények működését! Indítsd el a programot, és navigálj tetszőleges böngészőben a <a href="http://localhost:5000">http://localhost:5000</a> weboldalra. Itt a <code>Products</code> menüpontban már látnod kell a termékeket felsoroló táblázatot. Ha valamelyik sorban a <code>Details</code> menüpontra kattintasz, akkor egy adott termék részleteit is látnod kell.</p>
</li>
</ol>
<div class="admonition failure">
<p class="admonition-title">Ha nem látsz egyetlen terméket se</p>
<p>Ha a weboldalon egyetlen termék se jelenik meg, de az oldal betöltésre kerül és nincs hiba, akkor az adatbázis elérésével van probléma. Valószínűleg nem létezik a megadott nevű adatbázis. Lásd fentebb az adatbázis konfigurálását.</p>
</div>
<h3 id="letrehozas">Létrehozás<a class="headerlink" href="#letrehozas" title="Permanent link">¶</a></h3>
<ol>
<li>
<p>Ebben a pontban az <code>InsertProduct(Product product)</code> függvényt valósítjuk meg. A bemenő <code>Models.Product</code> modell adatait a felhasználó szolgáltatja a felhasználói felületen keresztül.</p>
</li>
<li>
<p>Egy termék létrehozásához először létre kell hoznunk egy új adatbázisentitás objektumot. Jelen esetben ez egy <code>Entites.Product</code> objektum lesz. Az <code>Id</code> értéket nem kell megadnunk — ezt majd az adatbázis generálja. A <code>Name</code>, <code>Price</code> és <code>Stock</code> értékeket a felhasználó szolgáltatja. Két érték maradt ki: az <code>Vat</code> és a <code>CategoryId</code>. Az előbbinek adjunk tetszőleges értéket, az utóbbinak pedig keressünk egy szimpatikus kategóriát az adatbázisban a <em>Studio 3T</em> segítségével, és annak az <code>_id</code> értékét drótozzuk be!</p>
<div class="highlight"><pre><span></span><code><span class="kt">var</span><span class="w"> </span><span class="n">dbProduct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Entities</span><span class="p">.</span><span class="n">Product</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">product</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span>
<span class="w">    </span><span class="n">Price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">product</span><span class="p">.</span><span class="n">Price</span><span class="p">,</span>
<span class="w">    </span><span class="n">Stock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">product</span><span class="p">.</span><span class="n">Stock</span><span class="p">,</span>
<span class="w">    </span><span class="n">Vat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Entities</span><span class="p">.</span><span class="n">Vat</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"General"</span><span class="p">,</span>
<span class="w">        </span><span class="n">Percentage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="n">CategoryId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ObjectId</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="s">"5d7e4370cffa8e1030fd2d99"</span><span class="p">),</span>
<span class="p">};</span>
<span class="n">_productCollection</span><span class="p">.</span><span class="n">InsertOne</span><span class="p">(</span><span class="n">dbProduct</span><span class="p">);</span>
</code></pre></div>
<p>Ha megvan az adatbázisentitás objektum, akkor az <code>InsertOne</code> utasítás segítségével tudjuk elmenteni az adatbázisba.</p>
</li>
<li>
<p>A függvény kipróbálásához indítsd el megint a programot, és a termékek táblázata feletti <code>Add new product</code> linkre kattints. Itt meg tudod adni a szükséges adatokat, amivel meghívódik a kódod.</p>
</li>
</ol>
<h3 id="torles">Törlés<a class="headerlink" href="#torles" title="Permanent link">¶</a></h3>
<ol>
<li>
<p>A törlés megvalósításához a <code>DeleteProduct(string id)</code> függvényt kell implementálni. Itt a kollekció <code>DeleteOne</code> függvényét kell használni. Ehhez meg kell adni egy filter kifejezést: itt használjuk ugyanazt a filtert, amit az egy konkrét termék lekérdezéséhez használtunk a <code>FindProduct(string id)</code> metódusban.</p>
</li>
<li>
<p>Ezt a metódust is ki tudod próbálni, ha a termékek táblázatában valamelyik sorban a <code>Delete</code> linkre kattintasz.</p>
</li>
</ol>
<h3 id="modositas">Módosítás<a class="headerlink" href="#modositas" title="Permanent link">¶</a></h3>
<ol>
<li>
<p>A termékek módosító utasításaként az eladást fogjuk megvalósítani, a <code>bool SellProduct(string id, int amount)</code> függvényben. A függvény akkor és csak akkor térjen vissza <code>true</code> értékkel, ha létezik az <code>id</code> azonosítójú termék, és legalább <code>amount</code> darab van belőle raktáron, amit el is tudtunk adni. Ha nem létezik a termék vagy nincs belőle elegendő, akkor térjen vissza <code>false</code> értékkel.</p>
</li>
<li>
<p>A MongoDB atomicitását kihasználva ezt a feladatot egyetlen utasítás kiadásával fogjuk megvalósítani. A filter kifejezésben fogunk rászűrni a megadott <code>id</code>-ra, és arra is, hogy elegendő termék van-e raktáron. A módosító kifejezésben fogjuk csökkenteni a raktárkészletet — csak akkor, ha létezik a termék, és elegendő van belőle raktáron.</p>
<div class="highlight"><pre><span></span><code><span class="kt">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_productCollection</span><span class="p">.</span><span class="n">UpdateOne</span><span class="p">(</span>
<span class="w">    </span><span class="n">filter</span><span class="p">:</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">Id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ObjectId</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">Stock</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">amount</span><span class="p">,</span>
<span class="w">    </span><span class="n">update</span><span class="p">:</span><span class="w"> </span><span class="n">Builders</span><span class="o">&lt;</span><span class="n">Entities</span><span class="p">.</span><span class="n">Product</span><span class="o">&gt;</span><span class="p">.</span><span class="n">Update</span><span class="p">.</span><span class="n">Inc</span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">Stock</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">amount</span><span class="p">),</span>
<span class="w">    </span><span class="n">options</span><span class="p">:</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UpdateOptions</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">IsUpsert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span><span class="w"> </span><span class="p">});</span>
</code></pre></div>
<p>Fontos megfigyelni, hogy az <code>UpdateOptions</code> segítségével jeleztük az adatbázisnak, hogy <strong>NE</strong> upsertet hajtson végre — tehát ne tegyen semmit ha nem találja a filterben megadott terméket.</p>
<p>A módosító utasítást a <code>Builders</code>-ben található <code>Update</code> builder segítségével tudjuk összerakni. Esetünkben <code>amount</code>-tal akarjuk csökkenteni az értéket — ez <code>-amount</code>-tal történő <em>inkrementálást</em> jelent.</p>
<p>A visszatérési értéket az update <code>result</code>-jából tudjuk meghatározni. Amennyiben talált olyan terméket, ami megfelelt a filternek, akkor sikeres volt a módosítás, tehát <code>true</code> értékkel térhetünk vissza. Egyébként a visszatérési érték <code>false</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">.</span><span class="n">MatchedCount</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">;</span>
</code></pre></div>
</li>
<li>
<p>Ezt a metódust is ki tudod próbálni, ha a termékek táblázatában valamelyik sorban a <code>Buy</code> linkre kattintasz. Próbáld ki úgy is, ha túl nagy értéket írsz be!</p>
</li>
</ol>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ</p>
<p>Készíts egy <strong>képernyőképet</strong> a termék listázó weboldalról <strong>miután felvettél legalább egy új terméket</strong>. A képet a megoldásban <code>f1.png</code> néven add be. A képernyőképen látszódjon a <strong>termék lista</strong>. Ellenőrizd, hogy a <strong>Neptun kódod</strong> (az oldal aljáról) látható-e a képen! A képernyőkép szükséges feltétele a pontszám megszerzésének.</p>
</div>
<h2 id="2-feladat-kategoriak-listazasa-4-pont">2. Feladat: Kategóriák listázása (4 pont)<a class="headerlink" href="#2-feladat-kategoriak-listazasa-4-pont" title="Permanent link">¶</a></h2>
<p>Ebben a feladatban a kategóriákat fogjuk listázni — az adott kategóriába tartozó termékek számával együtt. Ehhez már aggregációs utasítást is használnunk kell majd. Továbbra is a <code>Dal.Repository</code> osztályba dolgozunk.</p>
<p>A megvalósítandó függvény a <code>IList&lt;Category&gt; ListCategories()</code>. Ennek minden kategóriát vissza kell adnia. A <code>Models.Category</code> osztály 3 adattagot tartalmaz.</p>
<ul>
<li><code>Name</code>: értelemszerűen a kategória neve</li>
<li><code>ParentCategoryName</code>: a kategória szülőkategóriájának neve. Amennyiben nincs szülőkategória, értéke legyen <code>null</code>.</li>
<li><code>NumberOfProducts</code>: a kategóriába tartozó termékek száma. Amennyiben nincs ilyen, értéke legyen <strong>0</strong>.</li>
</ul>
<p>A megvalósítás lépései a következők.</p>
<ol>
<li>
<p>Első lépésként a <code>_productCollection</code> mintájára vedd fel és inicializáld a <code>_categoryCollection</code>-t is. Az adatbázisban a kollekció neve <code>categories</code> — ezt <em>Studio 3T</em> segítségével tudod ellenőrizni.</p>
</li>
<li>
<p>A <code>ListCategories()</code> metódusban először kérdezzük le a kategóriák teljes listáját. Ez pontosan ugyanúgy történik, mint az előző feladatban a termékek esetében. A lekérdezés értékét tegyük a <code>dbCategories</code> változóba.</p>
</li>
<li>
<p>Ezután kérdezzük le, hogy az egyes <code>CategoryId</code>-khez hány darab termék tartozik. Ehhez aggregációs pipeline-t kell használnunk, azon belül pedig a <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/group/"><code>$group</code></a> lépést.</p>
<div class="highlight"><pre><span></span><code><span class="kt">var</span><span class="w"> </span><span class="n">productCounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_productCollection</span>
<span class="w">    </span><span class="p">.</span><span class="n">Aggregate</span><span class="p">()</span>
<span class="w">    </span><span class="p">.</span><span class="n">Group</span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">CategoryID</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">CategoryID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g</span><span class="p">.</span><span class="n">Key</span><span class="p">,</span><span class="w"> </span><span class="n">NumberOfProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g</span><span class="p">.</span><span class="n">Count</span><span class="p">()</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="p">.</span><span class="n">ToList</span><span class="p">();</span>
</code></pre></div>
<p>Ez az utasítás egy olyan listával tér vissza, melyben minden elem egy <code>CategoryID</code> értéket tartalmaz a hozzá tartozó termékek számával együtt.</p>
</li>
<li>
<p>Ezen a ponton minden számunkra szükséges információ rendelkezésünkre áll — ismerjük az összes kategóriát (a szülőkategória megkereséséhez), és ismerjük a kategóriákhoz tartozó termékek számát. Egyetlen dolgunk van, hogy ezeket az információkat (C# kódból) "összefésüljük".</p>
<div class="highlight"><pre><span></span><code><span class="k">return</span><span class="w"> </span><span class="n">dbCategories</span>
<span class="w">    </span><span class="p">.</span><span class="n">Select</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Category</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span>
<span class="w">        </span><span class="n">ParentCategoryName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">.</span><span class="n">ParentCategoryId</span><span class="p">.</span><span class="n">HasValue</span>
<span class="w">            </span><span class="o">?</span><span class="w"> </span><span class="n">dbCategories</span><span class="p">.</span><span class="n">Single</span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">Id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span><span class="p">.</span><span class="n">ParentCategoryId</span><span class="p">.</span><span class="n">Value</span><span class="p">).</span><span class="n">Name</span>
<span class="w">            </span><span class="p">:</span><span class="w"> </span><span class="k">null</span><span class="p">,</span>
<span class="w">        </span><span class="n">NumberOfProducts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">productCounts</span><span class="p">.</span><span class="n">SingleOrDefault</span><span class="p">(</span><span class="n">pc</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">pc</span><span class="p">.</span><span class="n">CategoryID</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">k</span><span class="p">.</span><span class="n">Id</span><span class="p">)</span><span class="o">?.</span><span class="n">NumberOfProducts</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="m">0</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="p">.</span><span class="n">ToList</span><span class="p">();</span>
</code></pre></div>
<p>Láthatjuk, hogy mind a két lépést egyszerűen elintézhetjük C#-ban LINQ segítségével. A szülőkategória nevéhez a kategóriák között kell keresnünk, a termékek darabszámához pedig az aggregáció eredményében keresünk.</p>
<div class="admonition tip">
<p class="admonition-title">Join Mongo-ban</p>
<p>Nem ez az egyetlen módja a gyűjtemények "összekapcsolásának" MongoDB-ben. Ugyan <code>join</code> nincs, de léteznek megoldások a gyűjteményeken átívelő lekérdezésekre. A fenti megoldás az adatbázis helyett C# kódban végzi el az összekapcsolást. Ez akkor praktikus, ha nem nagy méretű adathalmazzal dolgozunk, és nincs (jó) szűrésünk. Ha szűrni kellene az adathalmazt, a fenti megoldás is bonyolultabb lenne a hatékonyság érdekében.</p>
</div>
</li>
<li>
<p>A kód kipróbálásához a weboldal <code>Categories</code> menüpontjára kell navigálni. Itt táblázatos formában megjelenítve láthatod az összegyűjtött információkat. Teszteléshez alkalmazhatod az előző feladatban elkészített <code>Add new product</code> funkciót — itt a hozzáadás esetén az egyik kategória mellett növekednie kell a hozzá tartozó termékek darabszámának. (A termék beszúrásakor a kategória ID-ját bedrótoztuk a kódba, tehát annak a kategóriának kell nőnie, amelyiknek az ID-ja a kódban szerepel.)</p>
</li>
</ol>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ</p>
<p>Készíts egy <strong>képernyőképet</strong> a kategória listázó weboldalról. A képet a megoldásban <code>f2.png</code> néven add be. A képernyőképen látszódjon a <strong>kategória lista</strong>. Ellenőrizd, hogy a <strong>Neptun kódod</strong> (az oldal aljáról) látható-e a képen! A képernyőkép szükséges feltétele a pontszám megszerzésének.</p>
</div>
<h2 id="3-feladat-megrendelesek-lekerdezese-es-modositasa-5-pont">3. Feladat: Megrendelések lekérdezése és módosítása (5 pont)<a class="headerlink" href="#3-feladat-megrendelesek-lekerdezese-es-modositasa-5-pont" title="Permanent link">¶</a></h2>
<p>Ebben a feladatban a Megrendelés (<code>Order</code>) entitáshoz tartozó CRUD (létrehozás, listázás/olvasás, módosítás és törlés) utasításokat fogjuk megvalósítani. Ez a feladat nagyon hasonlít az első feladathoz, amennyiben elakadnál nyugodtan meríts ihletet az ottani megoldásokból!</p>
<p>A <code>Models.Order</code> entitás adattagjai:</p>
<ul>
<li><code>Id</code>: az adatbázisentitás <code>Id</code>-ja, <code>ToString</code>-gel sorosítva</li>
<li><code>Date</code>, <code>Deadline</code>, <code>Status</code>: egy az egyben másolandók az adatbázis entitásból</li>
<li><code>PaymentMethod</code>: az adatbázis entitásban található <code>PaymentMethod</code> komplex objektum <code>Method</code> mezője</li>
<li><code>Total</code>: a megrendelésben található tételek (<code>OrderItems</code>) <code>Amount</code> és <code>Price</code> szorzatainak összege</li>
</ul>
<p>Ennek a feladatnak a megoldásához a megrendeléssel kapcsolatos metódusok implementációja szükséges (<code>ListOrders</code>, <code>FindOrder</code>, <code>InsertOrder</code>, <code>DeleteOrder</code> és <code>UpdateOrder</code>).</p>
<p>Az alábbi feladatok előtt ne felejtsd el felvenni és inicializálni a <code>_orderCollection</code>-t a repository osztályba a korábban látottak mintájára!</p>
<h3 id="listazasolvasas_1">Listázás/olvasás<a class="headerlink" href="#listazasolvasas_1" title="Permanent link">¶</a></h3>
<ol>
<li>
<p>A <code>ListOrders</code> függvény paraméterként kap egy <code>string status</code> értéket. Ha ez az érték üres vagy <code>null</code> (lásd: <code>string.IsNullOrEmpty</code>), akkor minden megrendelést listázz. Ellenkező esetben csak azokat a megrendeléseket listázd, melyeknek a <code>Status</code> értéke teljesen egyezik a paraméterben érkező <code>status</code> értékkel.</p>
</li>
<li>
<p>A <code>FindOrder</code> metódus egy konkrét megrendelés adatait adja vissza a <code>string id</code> érték alapján szűrve. Figyelj oda, ha az adott <code>ID</code> érték nem található az adatbázisban, akkor <code>null</code> értéket adj vissza!</p>
</li>
</ol>
<h3 id="letrehozas_1">Létrehozás<a class="headerlink" href="#letrehozas_1" title="Permanent link">¶</a></h3>
<ol>
<li>
<p>Az <code>InsertOrder</code> metódusban a létrehozást kell megvalósítanod. Ehhez háromféle információt kapsz: <code>Order order</code>, <code>Product product</code> és <code>int amount</code>.</p>
</li>
<li>
<p>Az adatbázisentitás létrehozásához a következő információkra van szükség:</p>
<ul>
<li><code>CustomerId</code>, <code>SiteId</code>: az adatbázisból keresd ki egy tetszőleges vevőhöz (<code>Customer</code>) tartozó dokumentum <code>_id</code> és <code>mainSiteId</code> értékét. Ezeket az értékeket drótozd bele a kódodba.</li>
<li><code>Date</code>, <code>Deadline</code>, <code>Status</code>: ezeket az értékeket az <code>order</code> paraméterből veheted</li>
<li><code>PaymentMethod</code>: hozz létre egy új <code>PaymentMethod</code> objektumot. A <code>Method</code> legyen az <code>order</code> paraméterben található <code>PaymentMethod</code> érték. A <code>Deadline</code> maradjon <code>null</code>!</li>
<li><code>OrderItems</code>: egyetlen tételt hozz létre! Ennek adattagjai:<ul>
<li><code>ProductId</code> és <code>Price</code>: a <code>product</code> paraméterből veheted</li>
<li><code>Amount</code>: a függvényparaméter <code>amount</code> paraméterből jön</li>
<li><code>Status</code>: az <code>order</code> paraméter <code>Status</code> mezőjével egyezik meg</li>
</ul>
</li>
<li>minden más adattag (a számlázással kapcsolatos információk) maradjon <code>null</code> értéken!</li>
</ul>
</li>
</ol>
<h3 id="torles_1">Törlés<a class="headerlink" href="#torles_1" title="Permanent link">¶</a></h3>
<p>A <code>DeleteOrder</code> törölje a megadott <code>Id</code>-hoz tartozó megrendelést.</p>
<h3 id="modositas_1">Módosítás<a class="headerlink" href="#modositas_1" title="Permanent link">¶</a></h3>
<p>A módosító utasításban (<code>UpdateOrder</code>) arra figyelj oda, hogy csak azokat a mezőket írd felül, melyek a <code>Models.Order</code> osztályban megtalálhatóak: <code>Date</code>, <code>Deadline</code>, <code>Status</code> és <code>PaymentMethod</code>. Az <code>Total</code>-t itt nem kell figyelembe venni, ennek értéke nem fog változni.</p>
<div class="admonition tip">
<p class="admonition-title">Tipp</p>
<p>Több módosító kifejezést a <code>Builders&lt;Entities.Order&gt;.Update.Combine</code> segítségével lehet összevonni.</p>
<p>Itt is figyelj oda, hogy az update során az <code>IsUpsert</code> beállítás értéke legyen <code>false</code>!</p>
</div>
<p>A metódus visszatérési értéke akkor és csak akkor legyen <code>true</code>, ha létezik megrendelés a megadott <code>ID</code>-val — azaz volt illeszkedés a filterre.</p>
<h3 id="kiprobalas">Kipróbálás<a class="headerlink" href="#kiprobalas" title="Permanent link">¶</a></h3>
<p>A megírt függvényeket a weboldalon a <code>Orders</code> menüpont alatt tudod kipróbálni. Teszteld le a <code>Filter</code>, <code>Add new order</code>, <code>Edit</code>, <code>Details</code> és <code>Delete</code> opciókat is!</p>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ</p>
<p>Készíts egy <strong>képernyőképet</strong> a megrendelés listázó weboldalról <strong>miután felvettél legalább egy új megrendelést</strong>. A képet a megoldásban <code>f3.png</code> néven add be. A képernyőképen látszódjon a <strong>megrendelések listája</strong>. Ellenőrizd, hogy a <strong>Neptun kódod</strong> (az oldal aljáról) látható-e a képen! A képernyőkép szükséges feltétele a pontszám megszerzésének.</p>
</div>
<h2 id="4-feladat-vevok-listazasa-4-pont">4. Feladat: Vevők listázása (4 pont)<a class="headerlink" href="#4-feladat-vevok-listazasa-4-pont" title="Permanent link">¶</a></h2>
<p>Ebben a feladatban a vevőket fogjuk listázni — az általuk megrendelt termékek összértékével együtt. Ehhez a második feladathoz hasonlatosan aggregációs utasítást és C# kódban történő "összefésülést" kell majd használnunk.</p>
<p>A megvalósítandó metódus az <code>IList&lt;Customer&gt; ListCustomers()</code>. Ennek minden vevőt vissza kell adnia. A <code>Models.Customer</code> entitás adattagjai:</p>
<ul>
<li><code>Name</code>: a vevő neve</li>
<li><code>ZipCode</code>, <code>City</code>, <code>Street</code>: a vevő központi telephelyéhez tartozó cím</li>
<li><code>TotalOrders</code>: a vevőhöz tartozó összes megrendelés összértékének (lásd előző feladat) összege. Amennyiben még nincs az adott vevőhöz tartozó megrendelés, akkor ennek az értéke legyen <code>null</code>!</li>
</ul>
<p>A feladat megoldásához ajánlott lépések:</p>
<ol>
<li>
<p>Vedd fel és inicializáld a <code>_customerCollection</code>-t!</p>
</li>
<li>
<p>Listázd ki az összes vevőt. A vevő entitásban megtalálod a telephelyek listáját (<code>Sites</code>) és a központi telephely azonosítóját (<code>MainSiteId</code>) is. Ez utóbbit kell megkeresned az előbbi listában, hogy megkapd a központi telephelyet (és így a hozzá tartozó címet).</p>
</li>
<li>
<p>A megrendelések kollekcióján aggregációs pipeline-t használva meg tudod állapítani az adott <code>CustomerId</code>-hez tartozó összmegrendelések értékét.</p>
</li>
<li>
<p>Végezetül csak a meglevő információkat kell "összefésülnöd". Központi telephelye minden vevőnek van, viszont megrendelése nem garantált — figyelj oda, hogy ekkor a <code>TotalOrders</code> elvárt értéke <code>null</code>!</p>
</li>
<li>
<p>A kód kipróbálásához a weboldal <code>Customers</code> menüpontjára kell navigálni. Itt táblázatos formában megjelenítve láthatod az összegyűjtött információkat. Teszteléshez alkalmazhatod az előző feladatban elkészített <code>Add new order</code> funkciót — itt új megrendelés felvétele esetén az előző feladatban bedrótozott vevő mellett növekednie kell a hozzá tartozó megrendelések összértékének.</p>
</li>
</ol>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ</p>
<p>Készíts egy <strong>képernyőképet</strong> a vevő listázó weboldalról. A képet a megoldásban <code>f4.png</code> néven add be. A képernyőképen látszódjon a <strong>vevők listája</strong>. Ellenőrizd, hogy a <strong>Neptun kódod</strong> (az oldal aljáról) látható-e a képen! A képernyőkép szükséges feltétele a pontszám megszerzésének.</p>
</div>
<h2 id="5-feladat-opcionalis-imsc-feladat-3-imsc-pont">5. Feladat: Opcionális (iMSc) feladat (3 iMsc pont)<a class="headerlink" href="#5-feladat-opcionalis-imsc-feladat-3-imsc-pont" title="Permanent link">¶</a></h2>
<p>Ebben a feladatban az adatbázisban található megrendeléseket fogjuk dátum szerint csoportosítani — kíváncsiak vagyunk ugyanis az elmúlt időszakokban a megrendelések mennyiségének és összértékének alakulására. Ennek megvalósításához a <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/bucket/"><code>$bucket</code></a> aggregációs lépést fogjuk használni.</p>
<h3 id="kovetelmenyek">Követelmények<a class="headerlink" href="#kovetelmenyek" title="Permanent link">¶</a></h3>
<p>A megvalósítandó metódus az <code>OrderGroups GroupOrders(int groupsCount)</code>. Ez az adatbázisban található megrendeléseket <code>groupsCount</code> egyenlő időintervallumra csoportosítja. A visszatérési érték két adattagot tartalmaz:</p>
<ul>
<li><code>IList&lt;DateTime&gt; Thresholds</code>: Az időpontok amik az időintervallumok határait jelentik.<ul>
<li>Az intervallumok alsó határa inkluzív, a felső határ exkluzív</li>
<li><code>n</code> darab intervallum esetén a <code>Thresholds</code> lista <code>n + 1</code> elemű</li>
<li><em>Pl.: Ha a <code>Thresholds</code> lista elemei <code>a, b, c, d</code>, akkor az időintervallumok a következők: <code>[a, b[</code>, <code>[b, c[</code> és <code>[c, d[</code>.</em></li>
</ul>
</li>
<li><code>IList&lt;OrderGroup&gt; Groups</code>: A megrendelések csoportjai. A <code>OrderGroup</code> entitás adattagjai:<ul>
<li><code>Date</code>: Az adott intervallum <em>kezdő</em> dátuma. Tehát <code>[a, b[</code> intervallum esetén <code>a</code>.</li>
<li><code>Pieces</code>: Az adott intervallumba eső megrendelések darabszáma.</li>
<li><code>Total</code>: Az adott intervallumba tartozó összes megrendelés összértékének összege (lásd előző feladat).</li>
</ul>
</li>
</ul>
<p>További követelmények:</p>
<ol>
<li>Pontosan <code>groupsCount</code> intervallumra bontsd a megrendeléseket.<ul>
<li>A <code>Thresholds</code> lista elemszáma így <strong>pontosan</strong> <code>groupsCount + 1</code>.</li>
<li>A <code>Groups</code> elemszáma <strong>legfeljebb</strong> <code>groupsCount</code> — az üres (megrendelést nem tartalmazó) intervallumoknak nem kell listaelem</li>
</ul>
</li>
<li>A legelső határ legyen az adatbázisban található legrégebbi megrendelés dátuma</li>
<li>A legutolsó határ legyen az adatbázisban található legújabb megrendelés dátuma + 1 óra<ul>
<li>Ez azért kell, mert az intervallum felső határa exkluzív. Így garantáljuk, hogy az adatbázisban található minden megrendelés belekerül egy intervallumba.</li>
<li><em>Tipp: a következő módon tudsz egy órát hozzáadni egy dátumhoz: <code>date.AddHours(1)</code>.</em></li>
</ul>
</li>
<li>Az intervallumok legyenek egyenlő méretűek<ul>
<li><em>Tipp: a C# nyelv beépítve kezeli matematikai műveletek végzését dátum (<code>DateTime</code>) és időtartam (<code>TimeSpan</code>) objektumokon — lásd pl. előző pont.</em></li>
</ul>
</li>
</ol>
<p>A megoldás során feltételezheted a következőket:</p>
<ul>
<li>Az adatbázisban található minden megrendelésnek van <code>Date</code> értéke, annak ellenére, hogy az adattag típusa <em>nullable</em> (<code>DateTime?</code>).<ul>
<li>Használd tehát nyugodtan a <code>date.Value</code> értéket a <code>date.HasValue</code> érték ellenőrzése nélkül.</li>
</ul>
</li>
<li>A <code>groupsCount</code> egy pozitív egész szám (tehát értéke <strong>legalább 1</strong>).</li>
</ul>
<h3 id="megoldas-vazlata">Megoldás vázlata<a class="headerlink" href="#megoldas-vazlata" title="Permanent link">¶</a></h3>
<ol>
<li>
<p>Kérdezd le az adatbázisból a legrégebbi és a legújabb megrendelés dátumát.</p>
<ul>
<li><em>Tipp: Ezt megoldhatod két lekérdezéssel vagy akár egyetlen aggregáció segítségével is.</em></li>
</ul>
</li>
<li>
<p>Számold ki az intervallumok határait a követelményeknek megfelelően.</p>
<ul>
<li>Ezzel már meg is fogod kapni a visszatérési értékben szükséges <code>Thresholds</code> listát.</li>
</ul>
</li>
<li>
<p>A megrendelések kollekción hajts végre egy <code>$bucket</code> aggregációt. Ennek dokumentációját <a href="https://docs.mongodb.com/manual/reference/operator/aggregation/bucket/">itt</a> találhatod meg.</p>
<ul>
<li>a <code>groupBy</code> kifejezés a megrendelés dátuma lesz</li>
<li>a <code>boundaries</code> kifejezés pontosan abban a formában várja az értékeket, amit a követelmények között is olvashattál, tehát az előző pontban előállított lista pontosan megfelel</li>
<li>az <code>output</code> kifejezésben fogalmazhatod meg a szükséges kiszámolandó értékeket (darabszám, összérték)</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tipp</p>
<p>Ha <code>"Element '...' does not match any field or property of class..."</code> kezdetű exceptiont kapsz, akkor az <code>output</code> kifejezésben írj át minden property-t <strong>kisbetűsre</strong> (pl.: <code>Pieces</code> -&gt; <code>pieces</code>). Úgy tűnik, hogy a Mongo C# driver ezen a ponton nem konzisztensen transzformálja az adattagok neveit.</p>
</div>
</li>
<li>
<p>A <code>$bucket</code> aggregáció az elvárt követelményeknek pontosan megfelelő intervallumokkal fog visszatérni, így az eredményét már csak transzformálni kell a megfelelő <code>OrderGroup</code> objektumok listájává, majd pedig előállítani a visszatérési értéket.</p>
</li>
<li>
<p>A kód kipróbálásához a weboldal <code>Group orders</code> menüpontjára kell navigálni. Itt diagramokon megjelenítve láthatod az összegyűjtött információkat. Tesztelés során módosítsd a csoportok számát, és vegyél fel új megrendeléseket különböző dátumokkal korábbi feladatokban elkészített <code>Add new order</code> segítségével!</p>
</li>
</ol>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ</p>
<p>Készíts egy <strong>képernyőképet</strong> a diagramokat mutató weboldalról. A képet a megoldásban <code>f5.png</code> néven add be. A képernyőképen látszódjon a <strong>két diagram</strong> (ehhez csökkentsd a böngészőben a nagyítást, hogy kiférjenek egy képernyőre). Ellenőrizd, hogy a <strong>Neptun kódod</strong> (az oldal aljáról) látható-e a képen! A képernyőkép szükséges feltétele a pontszám megszerzésének.</p>
</div>
<hr/>
<div class="md-source-file">
<span class="md-source-file__fact"> <span class="md-icon" title="Utolsó frissítés"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z">
</path>
</svg>
</span>
<span title="2023. március 3. 13:26:24">
<span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2023-03-03T13:26:24+01:00" locale="hu"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-03-03</span>
</span>
</span>
<span class="md-source-file__fact">
<span class="md-icon" title="Létrehozva"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z">
</path>
</svg>
</span>
<span title="2020. július 6. 08:06:03">
<span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2020-07-06T08:06:03+02:00" locale="hu"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2020-07-06</span>
</span>
</span>
<span class="md-source-file__fact">
<span class="md-icon" title="Szerzők">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z">
</path>
</svg>
</span>
<span>Szerzők</span>
<nav><a class="md-author" href="https://github.com/akosdudas" rel="noopener noreferrer" target="_blank" title="@akosdudas">
<img alt="@akosdudas" src="https://avatars.githubusercontent.com/u/11335181?size=72"/>
</a><a class="md-author" href="https://github.com/ialbert-AUT" rel="noopener noreferrer" target="_blank" title="@ialbert-AUT">
<img alt="@ialbert-AUT" src="https://avatars.githubusercontent.com/u/61751571?size=72"/>
</a><a class="md-author" href="https://github.com/tibitoth" rel="noopener noreferrer" target="_blank" title="@tibitoth">
<img alt="@tibitoth" src="https://avatars.githubusercontent.com/u/8333960?size=72"/>
</a></nav>
</span>
</div>
</article>
</div>
</div>
<a class="md-top md-icon" data-md-component="top" hidden="" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
            Vissza a tetejére
          </a>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © BME-VIK-AUT
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.instant", "navigation.top", "search.suggest", "content.action.edit"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "V\u00e1g\u00f3lapra m\u00e1solva", "clipboard.copy": "M\u00e1sol\u00e1s v\u00e1g\u00f3lapra", "search.result.more.one": "1 tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.more.other": "# tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.none": "Nincs tal\u00e1lat", "search.result.one": "1 egyez\u0151 dokumentum", "search.result.other": "# egyez\u0151 dokumentum", "search.result.placeholder": "Keres\u00e9shez \u00edrj ide valamit", "search.result.term.missing": "\u00dcres", "select.version": "Verzi\u00f3v\u00e1lt\u00e1s"}}</script>
<script src="../assets/javascripts/bundle.ce72ebac.min.js"></script>
<script src="../js/timeago.min.js"></script>
<script src="../js/timeago_mkdocs_material.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>